---
phase: 03-data-model-and-core-crud
plan: 03
type: execute
wave: 3
depends_on: ["03-02"]
files_modified:
  - app/(dashboard)/investors/page.tsx
  - components/investors/quick-create-modal.tsx
  - components/investors/investor-list-table.tsx
  - app/(dashboard)/layout.tsx
autonomous: true

must_haves:
  truths:
    - "User can navigate to /investors from the dashboard header"
    - "User can open quick create modal from the investors page"
    - "User can fill in Firm Name, Stage, and Relationship Owner and submit"
    - "After creation, user is redirected to the new investor detail page"
    - "Investors page shows a list of existing investors with firm name, stage, and primary contact"
  artifacts:
    - path: "app/(dashboard)/investors/page.tsx"
      provides: "Investors list page with create button"
      min_lines: 30
    - path: "components/investors/quick-create-modal.tsx"
      provides: "Modal form with 3 required fields"
      contains: "firm_name"
    - path: "components/investors/investor-list-table.tsx"
      provides: "Table displaying investor records"
      contains: "investors"
  key_links:
    - from: "components/investors/quick-create-modal.tsx"
      to: "app/actions/investors.ts"
      via: "Calls createInvestor server action on submit"
      pattern: "createInvestor"
    - from: "app/(dashboard)/investors/page.tsx"
      to: "app/actions/investors.ts"
      via: "Calls getInvestors to fetch list data"
      pattern: "getInvestors"
    - from: "components/investors/quick-create-modal.tsx"
      to: "app/(dashboard)/investors/[id]/page.tsx"
      via: "router.push to detail page after creation"
      pattern: "router\\.push.*investors"
---

<objective>
Create the investors list page with navigation, a quick create modal for new investors, and a basic table showing existing records.

Purpose: Entry point for all investor operations. Quick create with only required fields (Firm Name, Stage, Relationship Owner) reduces friction — users fill details on the full detail page after creation.
Output: Navigable investors page with create flow that redirects to detail page.
</objective>

<execution_context>
@/Users/RAZER/.claude/get-shit-done/workflows/execute-plan.md
@/Users/RAZER/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-data-model-and-core-crud/03-CONTEXT.md
@.planning/phases/03-data-model-and-core-crud/03-02-SUMMARY.md
@types/investors.ts
@app/actions/investors.ts
@app/(dashboard)/layout.tsx
@components/ui/dialog.tsx
@components/ui/button.tsx
@components/ui/input.tsx
@components/ui/table.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create investors list page with navigation link</name>
  <files>
    app/(dashboard)/investors/page.tsx
    components/investors/investor-list-table.tsx
    app/(dashboard)/layout.tsx
  </files>
  <action>
**app/(dashboard)/investors/page.tsx** — Server component:
- Call `getInvestors()` server action to fetch all investors
- Render page header with title "Investor Pipeline" and a "New Investor" button that opens the quick create modal
- Render `InvestorListTable` component with investors data
- If no investors, show empty state: "No investors yet. Create your first investor record to get started."

**components/investors/investor-list-table.tsx** — Client component ('use client'):
- Accept `investors: Investor[]` prop
- Display as a table using shadcn/ui Table components (already installed)
- Columns: Firm Name, Stage (with colored badge), Relationship Owner, Est. Value (formatted), Last Action Date, Stalled (indicator)
- Each row is clickable — navigates to `/investors/${investor.id}`
- Stage badges should use muted color coding (dark theme friendly):
  - Early stages (Not Yet Approached, Initial Contact): zinc/gray
  - Active stages (First Conversation, Materials Shared, NDA): blue
  - Hot stages (Due Diligence, LPA/Legal): amber/yellow
  - Terminal (Won, Committed): green; (Lost, Passed): red; (Delayed): orange
- Format est_value as currency: `$1,000,000` format using Intl.NumberFormat
- Format dates as relative ("3 days ago") or short date ("Jan 15")
- Show stalled indicator as a small warning icon if stalled === true

**app/(dashboard)/layout.tsx** — Update existing layout:
- Add navigation links in the header between the title and the user info section
- Add links: "Pipeline" -> /investors, "Settings" -> /settings/users
- Use a simple horizontal nav with active state highlighting (compare pathname)
- Keep existing header structure (title left, user email + sign out right)
- Wrap nav items in a `<nav>` element

NOTE: The layout must remain a server component. Navigation active state can use a client component wrapper or just render both links without active highlighting for now (Phase 4 will build proper nav).
  </action>
  <verify>
Read all files. Verify: (1) investors/page.tsx calls getInvestors(), (2) InvestorListTable renders table rows with Link to detail page, (3) layout.tsx has navigation link to /investors, (4) Empty state renders when no investors. Run `npx tsc --noEmit`.
  </verify>
  <done>Investors page renders at /investors with table of existing records, navigation link exists in header, empty state shown when no data</done>
</task>

<task type="auto">
  <name>Task 2: Create quick create modal with required fields</name>
  <files>
    components/investors/quick-create-modal.tsx
  </files>
  <action>
**components/investors/quick-create-modal.tsx** — Client component ('use client'):

Build a modal dialog using shadcn/ui Dialog components for creating new investors.

Props: `open: boolean`, `onOpenChange: (open: boolean) => void`

Form fields (use react-hook-form with zodResolver):
1. **Firm Name** — text input, required, autofocus
2. **Stage** — select dropdown populated from INVESTOR_STAGES array (from lib/validations/investor-schema.ts). Default to "Initial Contact"
3. **Relationship Owner** — text input, required

Form behavior:
- Validate with `investorCreateSchema` via zodResolver
- On submit: call `createInvestor` server action
- Show loading state on submit button ("Creating..." with disabled state)
- On success: close modal, redirect to `/investors/${newInvestor.id}` using `useRouter().push()`
- On error: show error message below the form (inline, not toast)
- On close/cancel: reset form state

Styling:
- Use shadcn/ui Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter
- Use shadcn/ui Input for text fields
- Use a native `<select>` styled with Tailwind for the stage dropdown (shadcn/ui Select requires additional installation — use native for now, Phase 4 can upgrade)
- Use shadcn/ui Button for submit and cancel
- Keep it clean and minimal — 3 fields, no extra decoration
- DialogDescription: "Add a new investor with basic information. You can fill in additional details on the investor page."

The "New Investor" button on the investors page should control this modal's open state.
  </action>
  <verify>
Read the component file. Verify: (1) Uses react-hook-form with zodResolver and investorCreateSchema, (2) All 3 required fields present (firm_name, stage, relationship_owner), (3) Calls createInvestor on submit, (4) Redirects to detail page on success, (5) Shows loading state during submission. Run `npx tsc --noEmit`.
  </verify>
  <done>Quick create modal opens from investors page, validates 3 required fields, creates investor via server action, and redirects to detail page on success</done>
</task>

</tasks>

<verification>
- Navigate to /investors in browser — page renders with table or empty state
- Header shows "Pipeline" navigation link
- "New Investor" button opens modal dialog
- Form validates required fields before submission
- After creation, redirects to /investors/[new-id]
- `npx tsc --noEmit` passes
</verification>

<success_criteria>
- Investors list page exists at /investors
- Quick create modal creates records with 3 required fields
- Navigation link in header reaches /investors
- Table renders investor data with clickable rows
- Creation flow redirects to detail page
</success_criteria>

<output>
After completion, create `.planning/phases/03-data-model-and-core-crud/03-03-SUMMARY.md`
</output>
